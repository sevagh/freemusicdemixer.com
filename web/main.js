let hamburgerMenu=document.getElementById("hamburger-menu"),navbarLinks=document.querySelector(".navbar-links"),modal=(hamburgerMenu.addEventListener("click",()=>{navbarLinks.classList.toggle("active")}),document.getElementById("login-modal")),loginBtn=document.getElementById("login-btn"),closeModal=document.querySelector(".close"),emailInput=document.getElementById("billing-email"),responseMessage=document.getElementById("response-message"),tierLogos={0:"/assets/images/logo_free.webp",2:"/assets/images/logo_pro.webp"},tierNames={0:"Free",2:"Pro"};function displayLoginSpinner(){console.log("Displaying spinner"),document.getElementById("login-overlay").style.display="flex",document.getElementById("login-spinner").style.display="flex"}function removeLoginSpinner(){document.getElementById("login-overlay").style.display="none",document.getElementById("login-spinner").style.display="none"}function activateProContent(t){displayLoginSpinner(),localStorage.setItem("billingEmail",t),trackProductEvent("Content Activated",{email:t}),fetch("https://freemusicdemixer.com/getprocontent?email="+encodeURIComponent(t)).then(e=>{if(e.ok)return e.json();throw removeLoginSpinner(),document.getElementById("response-message").innerHTML='Login failed. If this is a mistake, <a href="/support" target="_blank" alt="contact-link">contact us</a>.',new Error("Failed to fetch content")}).then(e=>{e=e.tier;console.log("User Tier: "+e),trackProductEvent("Tier Activated",{email:t,userTier:e}),sessionStorage.setItem("loggedIn","true"),sessionStorage.setItem("userTier",e),activateTierUI(e)}).catch(e=>console.error("Error fetching user tier:",e))}function activateTierUI(e){removeLoginSpinner();var t=document.querySelector("#logo-display img"),n=document.querySelector("#logo-display small"),n=(t&&n&&(t.src=tierLogos[e],t.alt=`freemusicdemixer-${tierNames[e].toLowerCase()}-logo`,n.textContent=tierNames[e]+" tier ",n.appendChild(t)),2===e&&(document.getElementById("response-message").innerHTML=tierNames[e]+' activated. <a class="wizard-link" href="https://billing.stripe.com/p/login/eVacPX8pKexG5tm8ww">Manage your subscription</a>.'),new CustomEvent("loginSuccess"));window.dispatchEvent(n)}loginBtn.addEventListener("click",()=>{modal.classList.add("show")}),closeModal.addEventListener("click",()=>{modal.classList.remove("show")}),window.addEventListener("click",e=>{e.target===modal&&modal.classList.remove("show")}),document.getElementById("activation-form").addEventListener("submit",function(e){e.preventDefault(),activateProContent(emailInput.value)}),document.addEventListener("DOMContentLoaded",function(){var e=localStorage.getItem("billingEmail"),e=(e&&(emailInput.value=e,responseMessage.textContent=""),"true"===sessionStorage.getItem("loggedIn"));let t=0;activateTierUI(t=!e||-1!==(t=parseInt(sessionStorage.getItem("userTier")))&&!isNaN(t)?t:0)});